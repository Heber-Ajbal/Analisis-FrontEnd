<mat-toolbar color="primary" class="toolbar">
  <span class="title">Panel administrativo</span>
  <span class="spacer"></span>

  <button mat-button [matMenuTriggerFor]="menuRango">
    <mat-icon>schedule</mat-icon>&nbsp;{{ rango() | uppercase }}
  </button>
  <mat-menu #menuRango="matMenu">
    <button mat-menu-item (click)="rango.set('7d')">Últimos 7 días</button>
    <button mat-menu-item (click)="rango.set('30d')">Últimos 30 días</button>
    <button mat-menu-item (click)="rango.set('ytd')">YTD</button>
    <button mat-menu-item (click)="rango.set('12m')">12 meses</button>
  </mat-menu>
</mat-toolbar>

<div class="container">
  <!-- KPIs -->
  <div class="kpi-grid">
    <mat-card class="kpi" *ngFor="let k of kpis">
      <div class="kpi-content">
        <mat-icon>{{ k.icon }}</mat-icon>
        <div>
          <div class="kpi-value">{{ k.value | number }}</div>
          <div class="kpi-label">{{ k.label }}</div>
        </div>
      </div>
    </mat-card>
  </div>

  <!-- Fila 1: 2 charts -->
  <div class="charts-grid">
    <mat-card class="chart-card">
      <mat-card-title>Evolución de Ventas</mat-card-title>
      <mat-card-content>
        <div class="chart-wrap">
          <canvas baseChart
                  [type]="lineChartType"
                  [data]="lineChartData"
                  [options]="lineChartOptions">
          </canvas>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="chart-card">
      <mat-card-title>Inventario vs. Rotación</mat-card-title>
      <mat-card-content>
        <div class="chart-wrap">
          <canvas baseChart
                  [data]="mixChartData"
                  [options]="mixChartOptions">
          </canvas>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Fila 2: 1 chart ancho -->
  <div class="charts-grid single">
    <mat-card class="chart-card">
      <mat-card-title>Distribución por Categoría</mat-card-title>
      <mat-card-content>
        <div class="chart-wrap tall">
          <canvas baseChart
                  [type]="doughnutType"
                  [data]="doughnutData"
                  [options]="doughnutOptions">
          </canvas>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Tablas -->
  <div class="tables-grid">
    <mat-card>
      <mat-card-title>Top Productos</mat-card-title>
      <mat-card-content>
        <table mat-table [dataSource]="topProductos" class="mat-elevation-z1 full-width">
          <ng-container matColumnDef="sku">
            <th mat-header-cell *matHeaderCellDef>SKU</th>
            <td mat-cell *matCellDef="let e">{{ e.sku }}</td>
          </ng-container>
          <ng-container matColumnDef="nombre">
            <th mat-header-cell *matHeaderCellDef>Producto</th>
            <td mat-cell *matCellDef="let e">{{ e.nombre }}</td>
          </ng-container>
          <ng-container matColumnDef="stock">
            <th mat-header-cell *matHeaderCellDef>Stock</th>
            <td mat-cell *matCellDef="let e">{{ e.stock }}</td>
          </ng-container>
          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
      </mat-card-content>
    </mat-card>

    <mat-card>
      <mat-card-title>Reposiciones Pendientes</mat-card-title>
      <mat-card-content>
        <table mat-table [dataSource]="pendientes" class="mat-elevation-z1 full-width">
          <ng-container matColumnDef="sku">
            <th mat-header-cell *matHeaderCellDef>SKU</th>
            <td mat-cell *matCellDef="let e">{{ e.sku }}</td>
          </ng-container>
          <ng-container matColumnDef="nombre">
            <th mat-header-cell *matHeaderCellDef>Producto</th>
            <td mat-cell *matCellDef="let e">{{ e.nombre }}</td>
          </ng-container>
          <ng-container matColumnDef="minimo">
            <th mat-header-cell *matHeaderCellDef>Mín.</th>
            <td mat-cell *matCellDef="let e">{{ e.minimo }}</td>
          </ng-container>
          <ng-container matColumnDef="actual">
            <th mat-header-cell *matHeaderCellDef>Actual</th>
            <td mat-cell *matCellDef="let e">{{ e.actual }}</td>
          </ng-container>
          <tr mat-header-row *matHeaderRowDef="displayedColumnsPend"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumnsPend;"></tr>
        </table>
      </mat-card-content>
    </mat-card>
  </div>
</div>
